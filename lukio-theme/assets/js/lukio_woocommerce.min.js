jQuery(document).ready(function(e){function t(e){return e.replaceAll(" ",".")}function i(e){lukio_helpers.animate_size(e,"height",0,400,0,{opacity:"0"},()=>{e.remove()})}function o(e){return 0!=e.siblings().length}function a(e){m&&h&&(localStorage.setItem(d,e),sessionStorage.setItem(d,e))}function r(t,i){t.each(function(){let t=this.outerHTML;e(this).remove(),i.append(t)}),n(i.find(".lukio_product_gallery_arrow:first-of-type"))}function l(e,t){let i=e[0].outerHTML;e.remove(),t.append(i)}function n(e){if(e.data("loop"))return;let t=e.closest(".flex-viewport"),i=t.find(".lukio_product_gallery_arrow"),o=t.siblings(".flex-control-nav").children("li"),a=o.find(".flex-active").closest("li").index(),r=0==a?"addClass":"removeClass",l=a==o.length-1?"addClass":"removeClass";i.filter(".prev")[r]("disable"),i.filter(".next")[l]("disable")}function c(){let t=e(".lukio_product_gallery_arrow"),i=e(".lukio_product_gallery_pagination"),o=t.closest(".flex-viewport");0!=t.length&&r(t,o),0!=i.length&&l(i,o)}let _=e(".lukio_mini_cart_wrapper"),s=e("body"),u=window.location.origin+window.location.pathname,d=wc_cart_fragments_params.cart_hash_key,g="wc_fragments_refreshed",f=u==lukio_woo.checkout_url,h=u==lukio_woo.cart_url||f,m=!0,p=!1;switch(u){case lukio_woo.checkout_url:g+=" updated_checkout";break;case lukio_woo.cart_url:g="updated_cart_totals wc_cart_emptied";break;default:g+=" wc_fragments_loaded"}try{window.sessionStorage.setItem("lukio_storage_check","test"),window.sessionStorage.removeItem("lukio_storage_check"),window.localStorage.setItem("lukio_storage_check","test"),window.localStorage.removeItem("lukio_storage_check")}catch(e){m=!1}m&&h&&e(window).on("storage onstorage",function(e){d===e.originalEvent.key&&localStorage.getItem(d)!==sessionStorage.getItem(d)&&(f&&(p=!0),s.trigger("lukio_update_wc_parts"))}),c(),s.on(g,function(){p?p=!1:e.ajax({method:"POST",url:lukio_localize.ajax_url,data:{action:"lukio_woocommerce_refresh_mini_cart"},success:function(i){if(i){if(i=JSON.parse(i),!1===s.triggerHandler("lukio_should_fully_refresh_minicart")){let o=document.createElement("div");o.innerHTML=i.fragment;let a=e(o);o.remove(),a.find(".always_refresh").each(function(){_.find("."+t(this.className)).html(this.innerHTML)}),s.trigger("lukio_minicart_not_fully_refreshed",[a])}else _.html(i.fragment);a(i.cart_hash),s.trigger("lukio_cart_num_refresh",[i.items_count]).trigger("lukio_refresh_mini_cart_extra",[i.extra]).trigger("lukio_minicart_refreshed")}}})}).on("should_send_ajax_request.adding_to_cart",function(e,t){if(t.hasClass("disabled"))return!1;let i=t.closest(".lukio_theme_add_to_cart_form_wrapper");if(1==i.length){let e=i.find('input[name="quantity"]');1==e.length&&t.attr("data-quantity",e.val());let o=i.find('input[name="variation_id"]');1==o.length&&t.attr("data-product_id",o.val())}}).on("lukio_update_wc_parts",function(){switch(window.location.origin+window.location.pathname){case lukio_woo.checkout_url:s.trigger("update_checkout");break;case lukio_woo.cart_url:s.trigger("wc_update_cart");break;default:s.trigger("wc_fragment_refresh")}}),e(document).on("click",".lukio_cart_product_quantity_btn",function(){let a=e(this),r=a.parent(),l=a.closest("li");if(r.hasClass("working")||a.hasClass("plus")&&r.hasClass("plus_disabled"))return;let n=parseInt(r.find(".lukio_cart_product_quantity_display").text());a.hasClass("minus")?n--:a.hasClass("plus")&&n++,r.addClass("working"),e.ajax({method:"POST",url:lukio_localize.ajax_url,data:{action:"lukio_update_cart_quantity",cart_item:r.data("key"),quantity:n},success:function(){if(1==l.closest(".lukio_mini_cart_wrapper").length){let e=o(l);(e||!e&&0!=n)&&s.one("lukio_should_fully_refresh_minicart",function(){return!1}).one("lukio_minicart_not_fully_refreshed",function(e,o){0!=n?l.html(o.find("."+t(l.attr("class"))).eq(l.index()).html()):i(l)})}s.trigger("lukio_update_wc_parts")}})}).on("click",".lukio_mini_cart_wrapper .remove",function(){let t=e(this).closest("li");o(t)?s.one("wc_fragments_loaded",function(){s.one("lukio_should_fully_refresh_minicart",function(){return!1}),h&&s.trigger("lukio_update_wc_parts")}).one("lukio_minicart_refreshed",function(){i(t)}):s.one("wc_fragments_loaded",function(){h&&s.trigger("lukio_update_wc_parts")})}).on("click",".lukio_product_gallery_arrow",function(){let t=e(this);if(t.hasClass("disbled"))return;let i=t.data("action"),o=t.data("loop"),a="next"==i?1:-1,r=t.closest(".woocommerce-product-gallery").find("ol.flex-control-nav"),l=r.children("li"),c=l.length-1,_=r.find(".flex-active").closest("li"),s=_.index()+a,u=t.siblings(".lukio_product_gallery_pagination");s<0?s=o?c:0:s>c&&(s=o?0:c),l.eq(s).find("img").trigger("click"),u.find(".lukio_product_gallery_pagination_dot.active").removeClass("active"),u.find(".lukio_product_gallery_pagination_dot").eq(s).addClass("active"),n(t)}).on("click",".lukio_product_gallery_pagination_dot",function(){let t=e(this);t.hasClass("active")||(e(".lukio_product_gallery_pagination_dot.active").removeClass("active"),t.addClass("active"),e(".woocommerce-product-gallery ol.flex-control-nav li").eq(t.data("index")).find("img").trigger("click"),n(t))})});