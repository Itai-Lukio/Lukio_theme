jQuery(document).ready(function(t){function e(t){return t.replaceAll(" ",".")}function a(t){lukio_helpers.animate_size(t,"height",0,400,0,{opacity:"0"},()=>{t.remove()})}function r(t){return 0!=t.siblings().length}function i(t){d&&u&&(localStorage.setItem(l,t),sessionStorage.setItem(l,t))}let o=t(".lukio_mini_cart_wrapper"),n=t("body"),_=window.location.origin+window.location.pathname,l=wc_cart_fragments_params.cart_hash_key,c="wc_fragments_refreshed",s=_==lukio_woo.checkout_url,u=_==lukio_woo.cart_url||s,d=!0,f=!1;switch(_){case lukio_woo.checkout_url:c+=" updated_checkout";break;case lukio_woo.cart_url:c="updated_cart_totals wc_cart_emptied";break;default:c+=" wc_fragments_loaded"}try{window.sessionStorage.setItem("lukio_storage_check","test"),window.sessionStorage.removeItem("lukio_storage_check"),window.localStorage.setItem("lukio_storage_check","test"),window.localStorage.removeItem("lukio_storage_check")}catch(t){d=!1}d&&u&&t(window).on("storage onstorage",function(t){l===t.originalEvent.key&&localStorage.getItem(l)!==sessionStorage.getItem(l)&&(s&&(f=!0),n.trigger("lukio_update_wc_parts"))}),n.on(c,function(){f?f=!1:t.ajax({method:"POST",url:lukio_localize.ajax_url,data:{action:"lukio_woocommerce_refresh_mini_cart"},success:function(a){if(a){if(a=JSON.parse(a),!1===n.triggerHandler("lukio_should_fully_refresh_minicart")){let r=document.createElement("div");r.innerHTML=a.fragment;let i=t(r);r.remove(),i.find(".always_refresh").each(function(){o.find("."+e(this.className)).html(this.innerHTML)}),n.trigger("lukio_minicart_not_fully_refreshed",[i])}else o.html(a.fragment);i(a.cart_hash),n.trigger("lukio_cart_num_refresh",[a.items_count]).trigger("lukio_refresh_mini_cart_extra",[a.extra]).trigger("lukio_minicart_refreshed")}}})}).on("should_send_ajax_request.adding_to_cart",function(t,e){if(e.hasClass("disabled"))return!1;let a=e.closest(".lukio_theme_add_to_cart_form_wrapper");if(1==a.length){let t=a.find('input[name="quantity"]');1==t.length&&e.attr("data-quantity",t.val());let r=a.find('input[name="variation_id"]');1==r.length&&e.attr("data-product_id",r.val())}}).on("lukio_update_wc_parts",function(){switch(window.location.origin+window.location.pathname){case lukio_woo.checkout_url:n.trigger("update_checkout");break;case lukio_woo.cart_url:n.trigger("wc_update_cart");break;default:n.trigger("wc_fragment_refresh")}}),t(document).on("click",".lukio_cart_product_quantity_btn",function(){let i=t(this),o=i.parent(),_=i.closest("li");if(o.hasClass("working")||i.hasClass("plus")&&o.hasClass("plus_disabled"))return;let l=parseInt(o.find(".lukio_cart_product_quantity_display").text());i.hasClass("minus")?l--:i.hasClass("plus")&&l++,o.addClass("working"),t.ajax({method:"POST",url:lukio_localize.ajax_url,data:{action:"lukio_update_cart_quantity",cart_item:o.data("key"),quantity:l},success:function(){if(1==_.closest(".lukio_mini_cart_wrapper").length){let t=r(_);(t||!t&&0!=l)&&n.one("lukio_should_fully_refresh_minicart",function(){return!1}).one("lukio_minicart_not_fully_refreshed",function(t,r){0!=l?_.html(r.find("."+e(_.attr("class"))).eq(_.index()).html()):a(_)})}n.trigger("lukio_update_wc_parts")}})}).on("click",".lukio_mini_cart_wrapper .remove",function(){let e=t(this).closest("li");r(e)?n.one("wc_fragments_loaded",function(){n.one("lukio_should_fully_refresh_minicart",function(){return!1}),u&&n.trigger("lukio_update_wc_parts")}).one("lukio_minicart_refreshed",function(){a(e)}):n.one("wc_fragments_loaded",function(){u&&n.trigger("lukio_update_wc_parts")})})});