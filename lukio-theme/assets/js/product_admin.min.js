jQuery(function(i){function a(a,o){i.ajax({method:"GET",url:woocommerce_admin_meta_boxes_variations.ajax_url,data:{action:"lukio_product_bulk_variations_image_preview",id:a},success:function(i){i&&(i=JSON.parse(i),!0===i.success&&o.attr("src",i.image_src))}})}function o(i){i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})}i(document).on("click",".lukio_product_bulk_variations_image_picker",function(o){o.preventDefault();let t=i(this),e=t.siblings("#lukio_product_bulk_variations_image_input"),_=t.siblings(".lukio_product_bulk_variations_image_img"),n=wp.media({title:t.data("popup-title"),multiple:!1,library:{type:"image"}});n.on("open",function(){let i=n.state().get("selection"),a=e.val(),o=wp.media.attachment(a);o.fetch(),i.add(o?[o]:[])}).on("close",function(){let i=n.state().get("selection");if(0==i.models.length)return;let o=i.models[0].id;e.val()!=o&&(e.val(o),a(o,_))}),n.open()}).on("click",".lukio_product_bulk_variations_image_btn",function(){let a=i(this),t=a.data("action"),e=a.closest("#lukio_product_bulk_variations_image"),_=e.find("#lukio_product_bulk_variations_image_nonce").val(),n=e.find("[name^=lukio_product_bulk_variations_image_select]").serialize(),l=e.find("#lukio_product_bulk_variations_image_input").val();o(e),i.ajax({method:"POST",url:woocommerce_admin_meta_boxes_variations.ajax_url,data:{action:"lukio_product_bulk_variations_image_set",image_id:l,type:t,post_id:woocommerce_admin_meta_boxes_variations.post_id,filters_str:n,nonce:_},success:function(a){e.unblock(),i(".variations-pagenav .page-selector").trigger("change")}})}).on("reload","#variable_product_options",function(){let a=i("#lukio_product_bulk_variations_image"),t=a.find("#lukio_product_bulk_variations_image_nonce").val();o(a),i.ajax({method:"GET",url:woocommerce_admin_meta_boxes_variations.ajax_url,data:{action:"lukio_product_bulk_variations_reload",post_id:woocommerce_admin_meta_boxes_variations.post_id,nonce:t},success:function(i){i&&(i=JSON.parse(i),a.html(i.fragment.trim().replace(/^<div[^>]*>||<\/div>$/g,"")),a.unblock())}})})});